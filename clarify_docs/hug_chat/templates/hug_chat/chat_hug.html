{% extends 'llm_chat/base.html' %}

{% load static %}
{% block content %}
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@10"></script>
<link rel="stylesheet" href="{% static 'llm_chat/styles.css' %}">
<title>Hug Chat</title>



<div id="mySidenav" class="sidebar">

    <div style="padding-top: 10px; padding-bottom: 10px;">
        <strong>Chat Info:</strong>
        <div style="display: flex;
    align-items: stretch;
    justify-content: space-between;
    flex-direction: column;
    padding: 10px;
    border: 1px dashed #ccc;
    border-radius: 5px;
    margin-bottom: 5px;">
            {% for cont in msg_list %}
            <span style="overflow-wrap: break-word; border-bottom: 1px solid #ccc; padding-bottom: 4px;">{{ cont }}</span>

            {% endfor %}
        </div>
    </div>
    <form method="post">
        {% csrf_token %}
        <button type="submit" class="btn btn-primary" name="create-new-chat">New Chat</button>
    </form>
</div>

<div class="chat-container">
    <div class="chat-history-container" id="chat-history-container">

        <div class="chat-history">

            <!-- Messages -->
            {% for request in requests %}

            <div class="text-center">
                <p>{{ request.created_at }}</p>
            </div>
            <div class="message sent">
                {% if avatar %}
                <img src="{{ avatar.image.url }}" alt="Avatar" style="float: right; margin-left: 20px;">
                {% else %}
                <img src="{% static 'llm_chat/img/human.png' %}" alt="Avatar" style="float: right; margin-left: 20px;">
                {% endif %}
                <p>{{ request.message }}</p>
            </div>
            <div class="message received">
                <img src="{% static 'llm_chat/img/bot.png' %}" alt="Avatar" class="right">
                <p>{{ request.answer }}</p>
            </div>

            {% endfor %}

            <!-- End messages -->
        </div> <!--chat-history cont-->
    </div>
    <div>
        <form action="/hug_chat/" method="post" id="questionForm">
                {% csrf_token %}

                <div style="flex: 1; display: flex;">
                    <input style="flex: 1; min-width: 0; margin-right: 5px;" class="form-control" type="text" id="textInput" name="text"
                        placeholder="Type your question here...">
                    <button style="flex-shrink: 0; margin: 5px;" type="submit" class="btn btn-primary">Generate</button>
                </div>
        </form>
    </div>
</div>
<script>
    var chatHistoryContainer = document.getElementById("chat-history-container");
    chatHistoryContainer.scrollTop = chatHistoryContainer.scrollHeight;
</script>

{% endblock %}
